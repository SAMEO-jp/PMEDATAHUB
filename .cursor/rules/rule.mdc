---
description: 
globs: 
alwaysApply: false
---
# ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ - Next.js App Router + TypeScript

## ğŸ¯ åŸºæœ¬æ–¹é‡
TypeScriptã€Node.jsã€Next.js App Routerã€Reactã€Shadcn UIã€Radix UIã€Tailwind CSSã®ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã¨ã—ã¦é–‹ç™ºã‚’è¡Œã„ã¾ã™ã€‚

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 
```
src/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ app_sample/         # ä¾‹:app_sample
â”‚   â”‚   â”œâ”€â”€ page.tsx       # ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ components/    # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ hooks/         # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ lib/           # APIãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â”œâ”€â”€ types/         # å‹å®šç¾©
â”‚   â”‚   â””â”€â”€ utils/         # ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
â”‚   â””â”€â”€ api/               # API Routes
â”œâ”€â”€ components/            # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ lib/                   # å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
â””â”€â”€ types/                 # ã‚°ãƒ­ãƒ¼ãƒãƒ«å‹å®šç¾©
```

## ğŸ—ï¸ ã‚³ãƒ¼ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ«ã¨æ§‹é€ 

### åŸºæœ¬åŸå‰‡
- **æ­£ç¢ºãªä¾‹ã‚’ç”¨ã„ã¦ã€ç°¡æ½”ã§æŠ€è¡“çš„ãª TypeScript ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã**
- **é–¢æ•°å‹ã¨å®£è¨€å‹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨ã—ã€ã‚¯ãƒ©ã‚¹ã¯é¿ã‘ã‚‹**
- **ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ã‚ˆã‚Šã‚‚åå¾©ã¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã‚’å„ªå…ˆã™ã‚‹**
- **è£œåŠ©å‹•è©(isLoading, hasErrorãªã©)ã‚’ç”¨ã„ãŸèª¬æ˜çš„ãªå¤‰æ•°åã‚’ä½¿ç”¨ã™ã‚‹**


## ğŸ·ï¸ å‘½åè¦å‰‡

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ»ãƒ•ã‚¡ã‚¤ãƒ«å
- **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: ãƒ€ãƒƒã‚·ãƒ¥ä»˜ãã®å°æ–‡å­—ï¼ˆä¾‹: `components/auth-wizard`ï¼‰
- **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: PascalCaseï¼ˆä¾‹: `UserProfile.tsx`ï¼‰
- **ãƒ•ãƒƒã‚¯**: camelCase with `use` prefixï¼ˆä¾‹: `useUserData.ts`ï¼‰
- **ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£**: camelCaseï¼ˆä¾‹: `dateUtils.ts`ï¼‰
- **å‹å®šç¾©**: PascalCase with `.types.ts` suffixï¼ˆä¾‹: `User.types.ts`ï¼‰

### å¤‰æ•°ãƒ»é–¢æ•°å
- **å¤‰æ•°**: èª¬æ˜çš„ãªåå‰ï¼ˆä¾‹: `isLoading`, `hasError`, `userData`ï¼‰
- **é–¢æ•°**: å‹•è© + åè©ï¼ˆä¾‹: `fetchUserData`, `handleSubmit`ï¼‰
- **å®šæ•°**: UPPER_SNAKE_CASEï¼ˆä¾‹: `API_ENDPOINTS`ï¼‰

## ğŸ”§ TypeScriptã®ä½¿ç”¨æ³•

### åŸºæœ¬åŸå‰‡
- **ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã«TypeScriptã‚’ä½¿ç”¨ã™ã‚‹**
- **åˆ—æŒ™å‹ã¯é¿ã‘ã€ä»£ã‚ã‚Šã«const assertionã‚’ä½¿ç”¨ã™ã‚‹**
- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å„ªå…ˆã—ã€typeã¯å¿…è¦æ™‚ã®ã¿ä½¿ç”¨ã™ã‚‹**

### å‹å®šç¾©ã®ä¾‹
```typescript
// ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆæ¨å¥¨ï¼‰
interface User {
  id: string;
  name: string;
  email: string;
  createdAt: Date;
}

// å®šæ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆåˆ—æŒ™å‹ã®ä»£æ›¿ï¼‰
const USER_STATUS = {
  ACTIVE: 'active',
  INACTIVE: 'inactive',
  PENDING: 'pending',
} as const;

type UserStatus = typeof USER_STATUS[keyof typeof USER_STATUS];

// Propså‹å®šç¾©
interface ComponentProps {
  data: User[];
  onSelect: (user: User) => void;
  isLoading?: boolean;
}
```

## ğŸ¨ UIã¨ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

### ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **Shadcn UI**: åŸºæœ¬UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **Radix UI**: ã‚¢ã‚¯ã‚»ã‚·ãƒ–ãƒ«ãªãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–
- **Tailwind CSS**: ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

### ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°åŸå‰‡
- **ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ã®å®Ÿè£…**
- **ä¸€è²«ã—ãŸã‚¹ãƒšãƒ¼ã‚·ãƒ³ã‚°ã¨ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ**
- **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã®è€ƒæ…®**

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¾‹
```tsx
interface ButtonProps {
  variant?: 'default' | 'destructive' | 'outline' | 'secondary' | 'ghost' | 'link';
  size?: 'default' | 'sm' | 'lg' | 'icon';
  children: React.ReactNode;
  onClick?: () => void;
  disabled?: boolean;
}

export function Button({ 
  variant = 'default', 
  size = 'default', 
  children, 
  onClick, 
  disabled 
}: ButtonProps) {
  return (
    <button
      className={cn(
        'inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors',
        'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring',
        'disabled:pointer-events-none disabled:opacity-50',
        buttonVariants({ variant, size })
      )}
      onClick={onClick}
      disabled={disabled}
    >
      {children}
    </button>
  );
}
```

## âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æœ€é©åŒ–

### React Server Components (RSC)
- **Server Componentsã‚’å„ªå…ˆä½¿ç”¨**
- **Client Componentsã¯å¿…è¦æœ€å°é™ã«**
- **ãƒ‡ãƒ¼ã‚¿å–å¾—ã¯Server Componentsã§å®Ÿè¡Œ**

### æœ€é©åŒ–ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯
```tsx
// Server Componentï¼ˆæ¨å¥¨ï¼‰
export default async function UserList() {
  const users = await fetchUsers(); // ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§å®Ÿè¡Œ
  return <UserTable users={users} />;
}

// Client Componentï¼ˆå¿…è¦æ™‚ã®ã¿ï¼‰
'use client';
export function UserTable({ users }: { users: User[] }) {
  const [selectedUser, setSelectedUser] = useState<User | null>(null);
  
  return (
    <div>
      {users.map(user => (
        <UserRow 
          key={user.id} 
          user={user} 
          onSelect={setSelectedUser}
        />
      ))}
    </div>
  );
}
```

### ãƒ¡ãƒ¢åŒ–ã¨æœ€é©åŒ–
```tsx
// useMemo for expensive calculations
const expensiveValue = useMemo(() => {
  return heavyCalculation(data);
}, [data]);

// useCallback for event handlers
const handleClick = useCallback((id: string) => {
  setSelectedId(id);
}, []);

// React.memo for component memoization
const UserRow = React.memo(({ user, onSelect }: UserRowProps) => {
  return (
    <div onClick={() => onSelect(user)}>
      {user.name}
    </div>
  );
});
```

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œï¼ˆSQLiteï¼‰

### åŸºæœ¬åŸå‰‡
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«**: `data/achievements.db`
- **å‹å®‰å…¨æ€§**: ã™ã¹ã¦ã®ã‚¯ã‚¨ãƒªã«å‹å®šç¾©ã‚’ä»˜ä¸
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: try-catchæ–‡ã§é©åˆ‡ã«å‡¦ç†

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œä¾‹
```typescript
// lib/db/db_connection.ts
import sqlite3 from 'sqlite3';
import { open } from 'sqlite';

export async function getDb() {
  return open({
    filename: 'data/achievements.db',
    driver: sqlite3.Database
  });
}

// lib/db/db_CRUD.ts
export async function getUserById(id: string): Promise<User | null> {
  try {
    const db = await getDb();
    const user = await db.get<User>('SELECT * FROM users WHERE id = ?', [id]);
    return user || null;
  } catch (error) {
    console.error('Failed to fetch user:', error);
    return null;
  }
}
```

## ğŸ”„ çŠ¶æ…‹ç®¡ç†

### åŸºæœ¬æ–¹é‡
- **ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹**: useState, useReducer
- **ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹**: Zustandï¼ˆå¿…è¦æ™‚ã®ã¿ï¼‰
- **ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹**: Server Components + ã‚­ãƒ£ãƒƒã‚·ãƒ¥

### Zustandä½¿ç”¨ä¾‹
```typescript
// store/userStore.ts
import { create } from 'zustand';

interface UserStore {
  user: User | null;
  setUser: (user: User | null) => void;
  isLoading: boolean;
  setIsLoading: (loading: boolean) => void;
}

export const useUserStore = create<UserStore>((set) => ({
  user: null,
  setUser: (user) => set({ user }),
  isLoading: false,
  setIsLoading: (isLoading) => set({ isLoading }),
}));
```

## ğŸš¨ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### åŸºæœ¬åŸå‰‡
- **é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º**
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼å‡¦ç†**
- **ãƒ­ã‚°å‡ºåŠ›ã«ã‚ˆã‚‹ãƒ‡ãƒãƒƒã‚°æ”¯æ´**

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä¾‹
```tsx
// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ¬ãƒ™ãƒ«
export default function UserProfile({ userId }: { userId: string }) {
  const [user, setUser] = useState<User | null>(null);
  const [error, setError] = useState<string | null>(null);
  const [isLoading, setIsLoading] = useState(true);

  useEffect(() => {
    async function fetchUser() {
      try {
        setIsLoading(true);
        setError(null);
        const userData = await getUserById(userId);
        setUser(userData);
      } catch (err) {
        setError('ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
        console.error('Failed to fetch user:', err);
      } finally {
        setIsLoading(false);
      }
    }

    fetchUser();
  }, [userId]);

  if (isLoading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div className="text-red-500">{error}</div>;
  if (!user) return <div>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</div>;

  return <UserCard user={user} />;
}
```

## ğŸ“± ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³

### Tailwind CSS ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆ
```tsx
// ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
<div className="
  w-full           // ãƒ¢ãƒã‚¤ãƒ«: 100%
  md:w-1/2         // ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ: 50%
  lg:w-1/3         // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—: 33%
  xl:w-1/4         // å¤§ç”»é¢: 25%
">
  <Card>
    <CardContent>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</CardContent>
  </Card>
</div>
```

## ğŸ” SEOãƒ»ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£

### ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¨­å®š
```tsx
// app/[feature]/page.tsx
export const metadata: Metadata = {
  title: 'ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«',
  description: 'ãƒšãƒ¼ã‚¸ã®èª¬æ˜',
  keywords: ['ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰1', 'ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰2'],
};
```

### ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£
```tsx
// ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯HTML
<main>
  <h1>ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</h1>
  <section aria-labelledby="section-title">
    <h2 id="section-title">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</h2>
    <button aria-label="è©³ç´°ã‚’é–‹ã">é–‹ã</button>
  </section>
</main>
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆæ–¹é‡
- **ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ**: é‡è¦ãªãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
- **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ**: è¤‡é›‘ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **E2Eãƒ†ã‚¹ãƒˆ**: é‡è¦ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼

### ãƒ†ã‚¹ãƒˆä¾‹
```typescript
// __tests__/components/Button.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { Button } from '../Button';

describe('Button', () => {
  it('renders with correct text', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByText('Click me')).toBeInTheDocument();
  });

  it('calls onClick when clicked', () => {
    const handleClick = jest.fn();
    render(<Button onClick={handleClick}>Click me</Button>);
    fireEvent.click(screen.getByText('Click me'));
    expect(handleClick).toHaveBeenCalledTimes(1);
  });
});
```

## ğŸ“‹ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

é–‹ç™ºæ™‚ã¯ä»¥ä¸‹ã®é …ç›®ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

- [ ] TypeScriptã®å‹å®‰å…¨æ€§ãŒç¢ºä¿ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] Server Componentsã‚’é©åˆ‡ã«ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ãŒè€ƒæ…®ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãŒç¢ºä¿ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæœ€é©åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] å‘½åè¦å‰‡ã«å¾“ã£ã¦ã„ã‚‹ã‹
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ãŒé©åˆ‡ã‹
- [ ] ãƒ†ã‚¹ãƒˆãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹ã‹ï¼ˆé‡è¦æ©Ÿèƒ½ï¼‰
- [ ] SEOå¯¾ç­–ãŒæ–½ã•ã‚Œã¦ã„ã‚‹ã‹

## ğŸš« é¿ã‘ã‚‹ã¹ããƒ‘ã‚¿ãƒ¼ãƒ³

- âŒ **anyå‹ã®ä½¿ç”¨**
- âŒ **éåŒæœŸå‡¦ç†ã®é©åˆ‡ã§ãªã„å‡¦ç†**
- âŒ **ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸå€¤**
- âŒ **ä¸é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
- âŒ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è€ƒæ…®ã—ãªã„å®Ÿè£…**
- âŒ **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã‚’ç„¡è¦–ã—ãŸå®Ÿè£…**
- âŒ **å‹å®‰å…¨æ€§ã‚’ç„¡è¦–ã—ãŸå®Ÿè£…**



