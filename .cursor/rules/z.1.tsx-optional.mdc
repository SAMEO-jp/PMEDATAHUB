---
description: 
globs: 
alwaysApply: false
---



## 3. ğŸ§  .tsx ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 3-1. ãƒ¡ãƒ¢åŒ–
```tsx
// React.memo ã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ¡ãƒ¢åŒ–
const MemoizedComponent = React.memo(function ComponentName({ data }: Props) {
  return <div>{/* JSX */}</div>;
});

// useMemo ã§è¨ˆç®—çµæœã‚’ãƒ¡ãƒ¢åŒ–
const expensiveValue = useMemo(() => {
  return data.filter(item => item.active).map(item => item.name);
}, [data]);

// useCallback ã§é–¢æ•°ã‚’ãƒ¡ãƒ¢åŒ–
const handleClick = useCallback((id: string) => {
  onAction?.(id);
}, [onAction]);
```

### 3-2. ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®é˜²æ­¢
```tsx
// âŒ é¿ã‘ã‚‹ã¹ãï¼šã‚¤ãƒ³ãƒ©ã‚¤ãƒ³é–¢æ•°
<button onClick={() => handleClick(id)}>Click</button>

// âœ… æ¨å¥¨ï¼šãƒ¡ãƒ¢åŒ–ã•ã‚ŒãŸé–¢æ•°
<button onClick={handleClick}>Click</button>

// âŒ é¿ã‘ã‚‹ã¹ãï¼šã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
<div style={{ color: 'red', fontSize: '16px' }}>Text</div>

// âœ… æ¨å¥¨ï¼šå®šæ•°ã¾ãŸã¯useMemo
const styles = useMemo(() => ({ color: 'red', fontSize: '16px' }), []);
<div style={styles}>Text</div>
```

### 3-3. æ¡ä»¶ä»˜ããƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®æœ€é©åŒ–
```tsx
// âŒ é¿ã‘ã‚‹ã¹ãï¼šè¤‡é›‘ãªæ¡ä»¶åˆ†å²
{isLoading ? (
  <LoadingSpinner />
) : error ? (
  <ErrorMessage error={error} />
) : data ? (
  <DataTable data={data} />
) : (
  <EmptyState />
)}

// âœ… æ¨å¥¨ï¼šæ—©æœŸãƒªã‚¿ãƒ¼ãƒ³
if (isLoading) return <LoadingSpinner />;
if (error) return <ErrorMessage error={error} />;
if (!data) return <EmptyState />;

return <DataTable data={data} />;
```

## 4. ğŸ”’ .tsx å‹å®‰å…¨æ€§

### 4-1. å‹å®šç¾©ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
```tsx
// âœ… æ¨å¥¨ï¼šå³å¯†ãªå‹å®šç¾©
interface UserData {
  id: string;
  name: string;
  email: string;
  role: 'admin' | 'user' | 'guest';
  createdAt: Date;
  updatedAt: Date;
}

// âœ… æ¨å¥¨ï¼šã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®æ˜ç¤º
interface ComponentProps {
  required: string;
  optional?: number;
  withDefault?: boolean;
}

// âœ… æ¨å¥¨ï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®å‹å®‰å…¨ãªè¨­å®š
const Component = ({ 
  required, 
  optional, 
  withDefault = false 
}: ComponentProps) => {
  // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
};
```

### 4-2. å‹ã‚¬ãƒ¼ãƒ‰ã®æ´»ç”¨
```tsx
// å‹ã‚¬ãƒ¼ãƒ‰é–¢æ•°
function isUserData(data: unknown): data is UserData {
  return (
    typeof data === 'object' &&
    data !== null &&
    'id' in data &&
    'name' in data &&
    'email' in data
  );
}

// å‹ã‚¬ãƒ¼ãƒ‰ã®ä½¿ç”¨
const handleData = (data: unknown) => {
  if (isUserData(data)) {
    // data ã¯ UserData å‹ã¨ã—ã¦æ‰±ãˆã‚‹
    console.log(data.name);
  }
};
```

### 4-3. ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã®æ´»ç”¨
```tsx
// ã‚¸ã‚§ãƒãƒªãƒƒã‚¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
interface ListProps<T> {
  items: T[];
  renderItem: (item: T, index: number) => React.ReactNode;
  keyExtractor: (item: T) => string;
}

function List<T>({ items, renderItem, keyExtractor }: ListProps<T>) {
  return (
    <ul>
      {items.map((item, index) => (
        <li key={keyExtractor(item)}>
          {renderItem(item, index)}
        </li>
      ))}
    </ul>
  );
}
```

## 5. ğŸ›¡ï¸ .tsx ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### 5-1. ã‚¨ãƒ©ãƒ¼ãƒã‚¦ãƒ³ãƒ€ãƒª
```tsx
// ErrorBoundary ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
class ErrorBoundary extends React.Component<
  { children: React.ReactNode },
  { hasError: boolean; error?: Error }
> {
  constructor(props: { children: React.ReactNode }) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError(error: Error) {
    return { hasError: true, error };
  }

  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {
    console.error('Error caught by boundary:', error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return <ErrorFallback error={this.state.error} />;
    }

    return this.props.children;
  }
}
```

### 5-2. éåŒæœŸå‡¦ç†ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
```tsx
// ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
const useAsyncData = <T>(fetchFn: () => Promise<T>) => {
  const [data, setData] = useState<T | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetchData = useCallback(async () => {
    try {
      setLoading(true);
      setError(null);
      const result = await fetchFn();
      setData(result);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Unknown error');
    } finally {
      setLoading(false);
    }
  }, [fetchFn]);

  return { data, loading, error, refetch: fetchData };
};
```

### 5-3. ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
```tsx
// ãƒ•ã‚©ãƒ¼ãƒ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
interface FormErrors {
  [key: string]: string;
}

const useFormValidation = <T extends Record<string, any>>(initialData: T) => {
  const [data, setData] = useState<T>(initialData);
  const [errors, setErrors] = useState<FormErrors>({});

  const validate = useCallback((field: keyof T, value: any): string | null => {
    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
    if (!value) return `${field} is required`;
    return null;
  }, []);

  const handleChange = useCallback((field: keyof T, value: any) => {
    setData(prev => ({ ...prev, [field]: value }));
    const error = validate(field, value);
    setErrors(prev => ({
      ...prev,
      [field]: error || ''
    }));
  }, [validate]);

  return { data, errors, handleChange };
};
```

## 6. â™¿ .tsx ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£

### 6-1. ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯HTML
```tsx
// âœ… æ¨å¥¨ï¼šã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãªHTMLæ§‹é€ 
<article className="user-profile">
  <header>
    <h1>User Profile</h1>
  </header>
  <main>
    <section aria-labelledby="personal-info">
      <h2 id="personal-info">Personal Information</h2>
      {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
    </section>
  </main>
</article>
```

### 6-2. ARIAå±æ€§ã®æ´»ç”¨
```tsx
// ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å±æ€§ã®ä½¿ç”¨
<button
  aria-label="Close modal"
  aria-describedby="modal-description"
  onClick={handleClose}
>
  Ã—
</button>

<div id="modal-description" className="sr-only">
  This will close the current modal dialog
</div>

// ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£
<label htmlFor="username">Username</label>
<input
  id="username"
  type="text"
  aria-required="true"
  aria-describedby="username-error"
  aria-invalid={!!errors.username}
/>
{errors.username && (
  <div id="username-error" role="alert" className="error">
    {errors.username}
  </div>
)}
```

### 6-3. ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
```tsx
// ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆã®å‡¦ç†
const handleKeyDown = useCallback((event: React.KeyboardEvent) => {
  switch (event.key) {
    case 'Enter':
      handleSubmit();
      break;
    case 'Escape':
      handleCancel();
      break;
    case 'Tab':
      // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç†
      break;
  }
}, [handleSubmit, handleCancel]);

// ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç†
const focusRef = useRef<HTMLInputElement>(null);

useEffect(() => {
  if (isVisible && focusRef.current) {
    focusRef.current.focus();
  }
}, [isVisible]);
```

## 7. ğŸ¨ .tsx ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

### 7-1. CSS-in-JS ãƒ‘ã‚¿ãƒ¼ãƒ³
```tsx
// styled-components ãƒ‘ã‚¿ãƒ¼ãƒ³
import styled from 'styled-components';

const StyledButton = styled.button<{ variant: 'primary' | 'secondary' }>`
  padding: 8px 16px;
  border: none;
  border-radius: 4px;
  background-color: ${props => 
    props.variant === 'primary' ? '#007bff' : '#6c757d'
  };
  color: white;
  cursor: pointer;
  
  &:hover {
    opacity: 0.8;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;

// CSS Modules ãƒ‘ã‚¿ãƒ¼ãƒ³
import styles from './Component.module.css';

const Component = () => (
  <div className={styles.container}>
    <h1 className={styles.title}>Title</h1>
  </div>
);
```

### 7-2. æ¡ä»¶ä»˜ãã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°
```tsx
// æ¡ä»¶ä»˜ãã‚¯ãƒ©ã‚¹å
const getClassName = (isActive: boolean, isDisabled: boolean) => {
  return [
    'base-class',
    isActive && 'active',
    isDisabled && 'disabled'
  ].filter(Boolean).join(' ');
};

// clsx/classnames ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ç”¨
import clsx from 'clsx';

const className = clsx(
  'base-class',
  {
    'active': isActive,
    'disabled': isDisabled
  }
);
```

## 8. ğŸ”„ .tsx çŠ¶æ…‹ç®¡ç†

### 8-1. ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ç®¡ç†
```tsx
// useState ã®é©åˆ‡ãªä½¿ç”¨
const [count, setCount] = useState(0);
const [user, setUser] = useState<User | null>(null);
const [loading, setLoading] = useState(false);

// useReducer ã®é©åˆ‡ãªä½¿ç”¨
interface State {
  count: number;
  loading: boolean;
}

type Action = 
  | { type: 'INCREMENT' }
  | { type: 'DECREMENT' }
  | { type: 'SET_LOADING'; payload: boolean };

const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case 'INCREMENT':
      return { ...state, count: state.count + 1 };
    case 'DECREMENT':
      return { ...state, count: state.count - 1 };
    case 'SET_LOADING':
      return { ...state, loading: action.payload };
    default:
      return state;
  }
};
```

### 8-2. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®æ´»ç”¨
```tsx
// ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ä½œæˆ
interface ThemeContextType {
  theme: 'light' | 'dark';
  toggleTheme: () => void;
}

const ThemeContext = React.createContext<ThemeContextType | undefined>(undefined);

// ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
export const ThemeProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [theme, setTheme] = useState<'light' | 'dark'>('light');

  const toggleTheme = useCallback(() => {
    setTheme(prev => prev === 'light' ? 'dark' : 'light');
  }, []);

  return (
    <ThemeContext.Provider value={{ theme, toggleTheme }}>
      {children}
    </ThemeContext.Provider>
  );
};

// ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
export const useTheme = () => {
  const context = React.useContext(ThemeContext);
  if (context === undefined) {
    throw new Error('useTheme must be used within a ThemeProvider');
  }
  return context;
};
```

## 9. ğŸ§ª .tsx ãƒ†ã‚¹ãƒˆ

### 9-1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ
```tsx
// React Testing Library ãƒ‘ã‚¿ãƒ¼ãƒ³
import { render, screen, fireEvent } from '@testing-library/react';
import { ComponentName } from './ComponentName';

describe('ComponentName', () => {
  it('renders correctly', () => {
    render(<ComponentName title="Test" />);
    expect(screen.getByText('Test')).toBeInTheDocument();
  });

  it('handles user interaction', () => {
    const mockOnAction = jest.fn();
    render(<ComponentName title="Test" onAction={mockOnAction} />);
    
    fireEvent.click(screen.getByRole('button'));
    expect(mockOnAction).toHaveBeenCalled();
  });
});
```

### 9-2. ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ
```tsx
// ãƒ•ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ
import { renderHook, act } from '@testing-library/react-hooks';
import { useCustomHook } from './useCustomHook';

describe('useCustomHook', () => {
  it('returns initial state', () => {
    const { result } = renderHook(() => useCustomHook());
    expect(result.current.data).toBeNull();
    expect(result.current.loading).toBe(false);
  });

  it('updates state correctly', async () => {
    const { result } = renderHook(() => useCustomHook());
    
    await act(async () => {
      await result.current.fetchData();
    });
    
    expect(result.current.loading).toBe(false);
  });
});
```

